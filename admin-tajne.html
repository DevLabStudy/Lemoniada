<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Admin</title>
    <link rel="stylesheet" href="style.css">
</head>
<body style="background:#222;">
<div class="app-container" style="width:90%; max-width:400px;">
    <h2 style="color:#333">Utarg: <span id="suma">0</span> zł</h2>
    <div id="list"></div>
    <button onclick="location.href='index.html'" style="background:gray">Powrót</button>
</div>

<script>
    const API = "TU_WKLEJ_LINK_Z_CLOUDFLARE";

    function load() {
        fetch(`${API}/list-zamowienia`).then(r => r.json()).then(data => {
            const l = document.getElementById('list');
            let s = 0; l.innerHTML = "";
            data.forEach(z => {
                s += parseFloat(z.suma);
                l.innerHTML += `
                    <div class="card" style="text-align:left; margin-bottom:10px; color:black; border-left: 5px solid ${z.status==='GOTOWE'?'green':'#17a2b8'}">
                        <small>${z.godzina} (ID: ${z.id})</small>
                        <p><b>${z.produkty}</b></p>
                        <p>${z.suma} zł | ${z.platnosc}</p>
                        <p>Status: ${z.status}</p>
                        <button onclick="upd(${z.id}, 'REALIZUJEMY')" style="background:#17a2b8; width:48%">Realizujemy</button>
                        <button onclick="upd(${z.id}, 'GOTOWE')" style="background:green; width:48%">Gotowe</button>
                    </div>`;
            });
            document.getElementById('suma').innerText = s.toFixed(2);
        });
    }

    function upd(id, ns) {
        fetch(`${API}/update-status`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({id, nowyStatus: ns})
        }).then(() => load());
    }

    setInterval(load, 4000);
    load();
</script>
</body>
</html>