<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Panel Admina - LemonIada</title>
    <style>
        body { font-family: sans-serif; background: #2c3e50; color: white; padding: 20px; }
        .box { background: #34495e; padding: 20px; border-radius: 15px; margin-bottom: 20px; }
        input, select { padding: 10px; margin: 5px; border-radius: 5px; border: none; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 10px; border-bottom: 1px solid #7f8c8d; text-align: left; }
        .status-btn { padding: 5px 10px; cursor: pointer; border-radius: 5px; border: none; }
        .btn-reset { background: #e74c3c; color: white; padding: 10px; cursor: pointer; border: none; border-radius: 5px; }
        .btn-add { background: #27ae60; color: white; font-weight: bold; }
    </style>
</head>
<body>

<h1>ğŸ‹ LemonIada - ZarzÄ…dzanie</h1>

<div class="box">
    <h3>â• Dodaj zamÃ³wienie rÄ™cznie</h3>
    <input type="text" id="manual-prod" placeholder="Co kupiÅ‚? (np. Klasyczna)">
    <input type="number" id="manual-price" placeholder="Cena (np. 5.00)">
    <select id="manual-pay">
        <option value="GotÃ³wka">GotÃ³wka</option>
        <option value="BLIK">BLIK</option>
    </select>
    <button class="status-btn btn-add" onclick="addManual()">DODAJ ZAMÃ“WIENIE</button>
</div>

<div class="box">
    <h3>ğŸ“¦ Magazyn i System</h3>
    Kubki: <input type="number" id="kubki-input" style="width:60px">
    <button onclick="updateKubki()">Ustaw</button>
    <button class="btn-reset" onclick="resetBazy()" style="margin-left: 50px;">ğŸ”¥ TWARDY RESET NUMERKÃ“W</button>
</div>

<div class="box">
    <h3>ğŸ“‹ Lista ZamÃ³wieÅ„</h3>
    <div id="lista"></div>
</div>

<script>
    const API = "https://bacterial-concept-scripting-expired.trycloudflare.com";

    function addManual() {
        const prod = document.getElementById('manual-prod').value;
        const cena = document.getElementById('manual-price').value;
        const platnosc = document.getElementById('manual-pay').value;
        if(!prod || !cena) return alert("Wpisz co i za ile!");

        fetch(`${API}/zamow`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ produkty: prod, suma: parseFloat(cena).toFixed(2), platnosc: platnosc, kod: "RÄ˜CZNE" })
        }).then(() => { alert("Dodano!"); load(); });
    }

    function load() {
        fetch(`${API}/list-zamowienia`).then(r => r.json()).then(data => {
            let html = `<table><tr><th>Nr</th><th>Produkty</th><th>Suma</th><th>PÅ‚atnoÅ›Ä‡</th><th>Status</th><th>Akcja</th></tr>`;
            data.forEach(z => {
                html += `<tr>
                    <td><b>#${z.id}</b></td>
                    <td>${z.produkty}</td>
                    <td>${z.suma} zÅ‚</td>
                    <td>${z.platnosc}</td>
                    <td>${z.status}</td>
                    <td>
                        <button class="status-btn" style="background:#f1c40f" onclick="upd(${z.id},'W REALIZACJI')">âš™ï¸</button>
                        <button class="status-btn" style="background:#2ecc71" onclick="upd(${z.id},'WYDANE')">âœ…</button>
                    </td>
                </tr>`;
            });
            document.getElementById('lista').innerHTML = html + `</table>`;
        });
    }

    function upd(id, status) {
        fetch(`${API}/update-status`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ id, nowyStatus: status })
        }).then(load);
    }

    function resetBazy() {
        if(confirm("Czy na pewno chcesz wyczyÅ›ciÄ‡ wszystko i zaczÄ…Ä‡ od numeru 1?")) {
            fetch(`${API}/reset-bazy`, { method: 'POST' }).then(() => { alert("Zresetowano!"); load(); });
        }
    }

    function updateKubki() {
        fetch(`${API}/ustaw-kubki`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ ilosc: document.getElementById('kubki-input').value })
        }).then(() => alert("Zaktualizowano kubki"));
    }

    setInterval(load, 3000);
    load();
</script>
</body>
</html>