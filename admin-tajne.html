<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Szef - Lemoniada</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; padding: 10px; margin: 0; }
        .card { background: #2d2d2d; padding: 15px; border-radius: 12px; margin-bottom: 10px; border: 1px solid #444; }
        .btn { padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; }
        .on { background: #27ae60; color: white; }
        .off { background: #e74c3c; color: white; }
        .order { background: white; color: black; padding: 12px; border-radius: 10px; margin-bottom: 10px; border-left: 8px solid #ccc; font-size: 14px; }
        .status-btn { width: 100%; margin-top: 10px; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; }
        input[type="number"] { padding: 10px; border-radius: 8px; border: none; width: 60px; text-align: center; }
    </style>
</head>
<body>
<div style="max-width: 500px; margin: auto;">
    <h2 style="color:#f1c40f">üçã Panel Szefa</h2>

    <div class="card" style="text-align:center;">
        <button id="p-btn" class="btn on" style="width:47%" onclick="togglePause()">OTWARTE</button>
        <button id="c-btn" class="btn on" style="width:47%" onclick="toggleCups()">KUBKI OK</button>
    </div>

    <div class="card">
        <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
            <span>Kubki: <b id="c-count">0</b></span>
            <span style="color:#2ecc71">Utarg: <b id="money">0.00</b> z≈Ç</span>
        </div>
        <input type="number" id="n-cups" placeholder="Ilo≈õƒá">
        <button class="btn on" onclick="setCups()">USTAW</button>
        <hr style="opacity:0.2; margin:15px 0;">
        <button class="btn on" style="width:48%" onclick="quick('Klasyk', 5.00)">+ KLASYK</button>
        <button class="btn on" style="width:48%" onclick="quick('Pomara≈Ñcz', 6.50)">+ POMAR</button>
    </div>

    <h3>üìù Zam√≥wienia Online</h3>
    <div id="list">Wczytywanie...</div>

    <button onclick="resetDay()" style="background:#e74c3c; color:white; width:100%; padding:15px; border:none; border-radius:10px; margin-top:30px; font-weight:bold;">WYCZY≈öƒÜ DZIE≈É</button>
</div>

<script>
    const API = "https://bacterial-concept-scripting-expired.trycloudflare.com";
    let isP = false, isC = false;

    function togglePause() { isP = !isP; sync(); }
    function toggleCups() { isC = !isC; sync(); }

    function sync() {
        const bp = document.getElementById('p-btn'); bp.className = `btn ${isP?'off':'on'}`; bp.innerText = isP?'PRZERWA':'OTWARTE';
        const bc = document.getElementById('c-btn'); bc.className = `btn ${isC?'off':'on'}`; bc.innerText = isC?'BRAK KUBK√ìW':'KUBKI OK';
        fetch(`${API}/ustaw-przerwe`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({przerwa:isP||isC, powod:isC?"Brak kubk√≥w!":"Zaraz wracamy!"})});
    }

    function setCups() {
        fetch(`${API}/ustaw-kubki`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({ilosc:document.getElementById('n-cups').value})});
    }

    function quick(p, s) {
        fetch(`${API}/sprzedaz-stacjonarna`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({produkty:p, suma:s.toFixed(2)})});
    }

    function load() {
        fetch(`${API}/stan-magazynu`).then(r=>r.json()).then(s => document.getElementById('c-count').innerText = s.kubki);
        fetch(`${API}/list-zamowienia`).then(r=>r.json()).then(data => {
            let m = 0, h = "";
            data.forEach(z => {
                m += parseFloat(z.suma);
                if(z.platnosc.includes("Stacjonarna")) return;
                let btn = "", col = "#f1c40f";
                if(z.status==='PRZYJƒòTE') btn = `<button class="status-btn" style="background:#3498db;color:white" onclick="upd(${z.id},'W REALIZACJI')">ROZPOCZNIJ</button>`;
                else if(z.status==='W REALIZACJI') { btn = `<button class="status-btn" style="background:#f1c40f" onclick="upd(${z.id},'DO ODBIORU')">GOTOWA</button>`; col="#3498db"; }
                else if(z.status==='DO ODBIORU') { btn = `<button class="status-btn" style="background:#2ecc71;color:white" onclick="upd(${z.id},'WYDANE')">WYDAJ</button>`; col="#2ecc71"; }
                h += `<div class="order" style="border-left:8px solid ${col}"><b>#${z.id}</b> | ${z.suma}z≈Ç | <b>${z.platnosc}</b><br><small>${z.produkty}</small><br>${btn}</div>`;
            });
            document.getElementById('money').innerText = m.toFixed(2);
            document.getElementById('list').innerHTML = h || "Brak zam√≥wie≈Ñ";
        });
    }

    function upd(id, s) { fetch(`${API}/update-status`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({id, nowyStatus:s})}); }
    function resetDay() { if(confirm("Reset?")) fetch(`${API}/reset-bazy`, {method:'POST'}); }
    setInterval(load, 3000); load();
</script>
</body>
</html>