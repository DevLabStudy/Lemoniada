<div id="admin-root" style="font-family:sans-serif; padding:20px;">
    <h1>Utarg: <span id="total">0.00</span> PLN</h1>
    <div id="list"></div>
    <hr>
    <h3>Podział na pracowników</h3>
    <input type="number" id="count" value="1" oninput="div()"> osób. Dla każdego: <b id="each">0</b> zł
</div>

<script>
    let currentUtarg = 0;
    async function load() {
        const r = await fetch('https://api.lemoniada.com.pl/api/admin/all');
        const d = await r.json();
        currentUtarg = d.utarg;
        document.getElementById('total').innerText = d.utarg.toFixed(2);
        let h = '';
        Object.values(d.zamowienia).reverse().forEach(o => {
            if(o.status === 'zrealizowane') return;
            h += `<div style="border:1px solid #333; padding:10px; margin:5px;">
                #${o.id} - ${o.rodzaj} (${o.platnosc}) - <b>${o.status}</b><br>
                <button onclick="st('${o.id}','przyjęte')">Przyjmij</button>
                <button onclick="st('${o.id}','w realizacji')">W realizacji</button>
                <button onclick="st('${o.id}','gotowe')">GOTOWE</button>
                <button onclick="st('${o.id}','zrealizowane')">ZREALIZOWANE ($)</button>
            </div>`;
        });
        document.getElementById('list').innerHTML = h;
        div();
    }
    async function st(id, s) {
        await fetch('https://api.lemoniada.com.pl/api/admin/status', {
            method:'POST', headers:{'Content-Type':'application/json'},
            body: JSON.stringify({id, nowyStatus:s})
        });
        load();
    }
    function div() {
        const c = document.getElementById('count').value || 1;
        document.getElementById('each').innerText = (currentUtarg / c).toFixed(2);
    }
    setInterval(load, 4000); load();
</script>